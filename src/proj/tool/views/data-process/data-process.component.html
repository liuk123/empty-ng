<div class="m-container page-top">
  <div class="info-panel">
    <h2>数据流程化处理</h2>
    <p>输入框中输入字符串，可用正则、JSON.parse等将其转换为Array(或Object)，然后对Array(或Object)进行处理。获得最终想要的数据。</p>
    <p>功能：数据格式转换、数据处理、数据查找等。</p>
    <p>可以F12查看每步的输出结果</p>
  </div>
  <div nz-row [nzGutter]="16">
    <div nz-col nzXs="24" nzSm="24" nzMd="16" nzLg="16">
      <h3>输入</h3>
      <textarea class="inputArea" rows="8" nz-input [(ngModel)]="inputValue" #inputEl></textarea>

      <h3>输出</h3>
      <textarea class="inputArea" rows="8" nz-input [(ngModel)]="resultValue"></textarea>
      <div class="mt-3 mb-3">
        <button (click)="copy(resultValue)">复制</button>
      </div>
    </div>
    <div nz-col nzXs="24" nzSm="24" nzMd="8" nzLg="8">
      <div [formGroup]="validateForm">
        <div formArrayName="processList">
          <div class="flex mb-2" *ngFor="let item of processList.controls; let i=index">
            <div style="flex: 1 1 auto;" [formGroupName]="i">
              <nz-select formControlName="value" (ngModelChange)="setInputValue(i)" style="width: 150px;">
                <nz-option *ngFor="let p of processOption" [nzValue]="p" [nzLabel]="p.name"></nz-option>
              </nz-select>
              <div>
                描述：{{processList?.value[i]?.value?.desc}} <br/>
                输入格式：{{processList?.value[i]?.value?.paramsType}}，
                输出格式：{{processList?.value[i]?.value?.returnType}}<br/>
                <!-- 参数：({{processList?.value[i]?.value?.params}}) -->
              </div>
              <textarea #textarea *ngIf="processList?.value[i]?.value?.inputStr" nz-input formControlName="inputStr" placeholder="Controlled autosize" [nzAutosize]="{ minRows: 3, maxRows: 5 }"></textarea>
              <textarea #textarea *ngIf="processList?.value[i]?.value?.fnBody" nz-input formControlName="fnBody" placeholder="Controlled autosize" [nzAutosize]="{ minRows: 3, maxRows: 5 }"></textarea>
            </div>

            <button nz-button nzType="primary" nz-popconfirm nzPopconfirmTitle="确定删除分类吗?" nzPopconfirmPlacement="bottom"
              (nzOnConfirm)="removeItem(i)">删除</button>
          </div>
        </div>
      </div>
      <button nz-button nzType="primary" (click)="addItem()">添加</button>
      <button nz-button nzType="primary" (click)="run()">执行</button>
    </div>
  </div>
</div>